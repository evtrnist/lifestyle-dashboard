@let shownWidget = $shownWidget();

<tui-tabs [(activeItemIndex)]="activeItemIndex">
  @for (tab of $tabs(); track $index) {
    <button
      [iconStart]="tab | widgetIcon | tuiIcon"
      tuiTab
      type="button"
      (click)="onClick(tab)"
    >
      {{ tab | widgetName }}
    </button>
  }
</tui-tabs>

@if (shownWidget) {
  <div class="widget-container">
    @let component = shownWidget.component;
    @let token = shownWidget.token;
    @let settingsComponent = shownWidget.settingsComponent;
    @let injector = createInjector(token);

    <lib-dynamic-host
      [component]="component"
      [injector]="injector"
    ></lib-dynamic-host>

    @if (settingsComponent) {
      <lib-dynamic-host
        [component]="settingsComponent"
        [injector]="injector"
        (init)="onSettingsInit($event)"
      ></lib-dynamic-host>
    }
  </div>
}

<div class="button-container">
  <button
    size="l"
    tuiButton
    type="button"
    class="button"
    appearance="secondary"
    (click)="save()"
  >
    Save
  </button>
</div>
