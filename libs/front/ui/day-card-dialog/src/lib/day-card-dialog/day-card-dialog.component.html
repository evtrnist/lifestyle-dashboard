<tui-tabs [activeItemIndex]="$activeItemIndex()">
  @for (tab of $tabs(); track $index; let index = $index) {
    <button
      [iconStart]="tab | widgetIcon | tuiIcon"
      tuiTab
      type="button"
      (click)="onClick(index)"
    >
      {{ tab | widgetName }}
    </button>
  }
</tui-tabs>

@if ($shownWidget(); as shownWidget) {
  <div class="widget-container">
    @let component = shownWidget.component;
    @let settingsComponent = shownWidget.settingsComponent;
    @let injector = $widgetInjector();

    <lib-dynamic-host
      [component]="component"
      [injector]="injector"
    ></lib-dynamic-host>

    @if (settingsComponent) {
      <lib-dynamic-host
        [component]="settingsComponent"
        [injector]="injector"
        (init)="onSettingsInit($event)"
      ></lib-dynamic-host>
    }
  </div>

  <div class="button-container">
    <button
      size="l"
      tuiButton
      type="button"
      class="button"
      appearance="secondary"
      (click)="save(shownWidget.key)"
    >
      Save
    </button>
  </div>
}
